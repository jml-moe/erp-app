{% extends 'dashboard_base.html' %}

{% block page_name %}
{{ adjustment.reference }}
{% endblock %}

{% block dashboard_content %}
<div class="max-w-4xl">
    <!-- Header -->
    <div class="mb-6 flex justify-between items-center">
        <div class="flex items-center gap-4">
            <h2 class="text-xl font-semibold">{{ adjustment.name }}</h2>
            <span class="px-3 py-1 text-sm rounded-full 
                {% if adjustment.state == 'done' %}bg-green-100 text-green-800
                {% elif adjustment.state == 'in_progress' %}bg-blue-100 text-blue-800
                {% else %}bg-neutral-100 text-neutral-700{% endif %}">
                {{ adjustment.get_state_display }}
            </span>
        </div>
    </div>
    
    <!-- Info -->
    <div class="bg-white rounded-lg border border-neutral-200 p-6 mb-6">
        <div class="grid grid-cols-3 gap-4">
            <div>
                <p class="text-sm text-neutral-500">Location</p>
                <p class="font-medium">{{ adjustment.location }}</p>
            </div>
            <div>
                <p class="text-sm text-neutral-500">Date</p>
                <p>{{ adjustment.date }}</p>
            </div>
            <div>
                <p class="text-sm text-neutral-500">Reference</p>
                <p class="font-mono">{{ adjustment.reference }}</p>
            </div>
        </div>
        
        {% if adjustment.notes %}
        <div class="mt-4 pt-4 border-t">
            <p class="text-sm text-neutral-500 mb-1">Notes</p>
            <p class="text-sm">{{ adjustment.notes }}</p>
        </div>
        {% endif %}
    </div>
    
    <!-- Lines -->
    <div class="bg-white rounded-lg border border-neutral-200 p-6 mb-6">
        <h3 class="text-lg font-semibold mb-4 text-neutral-800">Adjustment Lines</h3>
        
        <table class="w-full">
            <thead>
                <tr class="border-b">
                    <th class="p-2 text-left">Product</th>
                    <th class="text-left w-20">UoM</th>
                    <th class="text-right w-28">System Qty</th>
                    <th class="text-right w-28">Counted Qty</th>
                    <th class="text-right w-28">Difference</th>
                </tr>
            </thead>
            <tbody>
                {% for line in lines %}
                <tr class="border-b last:border-0">
                    <td class="p-2">{{ line.product.name }}</td>
                    <td>{{ line.product.uom.symbol }}</td>
                    <td class="text-right font-mono">{{ line.theoretical_qty|floatformat:2 }}</td>
                    <td class="text-right font-mono">{{ line.counted_qty|floatformat:2 }}</td>
                    <td class="text-right font-mono {% if line.difference < 0 %}text-red-600{% elif line.difference > 0 %}text-green-600{% endif %}">
                        {% if line.difference > 0 %}+{% endif %}{{ line.difference|floatformat:2 }}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="p-4 text-center text-neutral-500">No adjustment lines.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- Back -->
    <a href="{% url 'adjustment-list' %}" class="bg-neutral-200 text-neutral-700 py-2 px-6 rounded-lg hover:bg-neutral-300 font-medium inline-block">
        &larr; Back to Adjustments
    </a>
</div>
{% endblock %}

